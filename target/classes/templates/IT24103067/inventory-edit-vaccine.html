<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      th:replace="~{fragments/inventory-layout :: inventoryLayout(~{::title}, ~{::content})}">
<head>
    <title>Edit Vaccine Stock - VaxConnect Sri Lanka</title>
</head>

<body>
<div th:fragment="content">
    <!-- Main Content -->
    <div class="p-8">
        <!-- Header -->
        <div class="mb-8">
            <div class="flex items-center justify-between">
                <div>
                    <h1 class="text-3xl font-bold text-gray-800">Edit Vaccine Stock</h1>
                    <p class="text-gray-600 mt-2">Update vaccine details and stock quantity</p>
                </div>
                <a th:href="@{/inventory/dashboard}" class="inline-flex items-center px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors">
                    <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
                    </svg>
                    Back to Dashboard
                </a>
            </div>
        </div>

        <!-- Success/Error Messages -->
        <div th:if="${successMessage}" class="mb-6 p-4 bg-green-50 border border-green-200 rounded-lg">
            <div class="flex items-center">
                <svg class="w-5 h-5 text-green-600 mr-2" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                </svg>
                <span class="text-green-800 font-medium" th:text="${successMessage}">Success message</span>
            </div>
        </div>

        <div th:if="${errorMessage}" class="mb-6 p-4 bg-red-50 border border-red-200 rounded-lg">
            <div class="flex items-center">
                <svg class="w-5 h-5 text-red-600 mr-2" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                </svg>
                <span class="text-red-800 font-medium" th:text="${errorMessage}">Error message</span>
            </div>
        </div>

        <!-- Form -->
        <div class="bg-white rounded-2xl shadow-sm border border-gray-200 p-8">
            <form th:action="@{/inventory/vaccine/update}" th:object="${vaccineToEdit}" method="post" class="space-y-6">
                <!-- Hidden field to pass the ID back to the controller -->
                <input type="hidden" th:field="*{id}" />
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- Vaccine Name -->
                    <div>
                        <label for="vaccineName" class="block text-sm font-medium text-gray-700 mb-2">
                            Vaccine Name <span class="text-red-500">*</span>
                        </label>
                        <input 
                            type="text" 
                            id="vaccineName" 
                            th:field="*{vaccineName}"
                            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors"
                            placeholder="Enter vaccine name"
                            required
                        >
                        <div th:if="${#fields.hasErrors('vaccineName')}" class="mt-1 text-sm text-red-600">
                            <span th:errors="*{vaccineName}">Vaccine name error</span>
                        </div>
                    </div>

                    <!-- Manufacturer -->
                    <div>
                        <label for="manufacturer" class="block text-sm font-medium text-gray-700 mb-2">
                            Manufacturer <span class="text-red-500">*</span>
                        </label>
                        <input 
                            type="text" 
                            id="manufacturer" 
                            th:field="*{manufacturer}"
                            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors"
                            placeholder="Enter manufacturer name"
                            required
                        >
                        <div th:if="${#fields.hasErrors('manufacturer')}" class="mt-1 text-sm text-red-600">
                            <span th:errors="*{manufacturer}">Manufacturer error</span>
                        </div>
                    </div>
                </div>

                <!-- Current Stock Quantity -->
                <div>
                    <label for="totalQuantity" class="block text-sm font-medium text-gray-700 mb-2">
                        Current Stock Quantity <span class="text-red-500">*</span>
                    </label>
                    <input 
                        type="number" 
                        id="totalQuantity" 
                        th:field="*{totalQuantity}"
                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors"
                        placeholder="Enter current quantity"
                        min="0"
                        required
                    >
                    <p class="mt-1 text-sm text-gray-500">Update the total available quantity for this vaccine</p>
                    <div th:if="${#fields.hasErrors('totalQuantity')}" class="mt-1 text-sm text-red-600">
                        <span th:errors="*{totalQuantity}">Quantity error</span>
                    </div>
                </div>

                <!-- Last Updated Display -->
                <div class="bg-gray-50 rounded-lg p-4">
                    <div class="flex items-center">
                        <svg class="w-5 h-5 text-gray-400 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                        <div>
                            <p class="text-sm font-medium text-gray-700">Last Updated</p>
                            <p class="text-sm text-gray-500" th:text="${vaccineToEdit.lastUpdated != null ? #temporals.format(vaccineToEdit.lastUpdated, 'MMM dd, yyyy') : 'Not available'}">Dec 15, 2024</p>
                        </div>
                    </div>
                </div>

                <!-- Form Actions -->
                <div class="flex items-center justify-end space-x-4 pt-6 border-t border-gray-200">
                    <a th:href="@{/inventory/dashboard}" class="px-6 py-3 text-gray-700 bg-gray-100 border border-gray-300 rounded-lg hover:bg-gray-200 transition-colors font-medium">
                        Cancel
                    </a>
                    <button type="submit" class="px-6 py-3 text-white font-semibold rounded-lg transition-all duration-200" style="background-color: #1E51DB;" onmouseover="this.style.backgroundColor='#1a47c4'" onmouseout="this.style.backgroundColor='#1E51DB'">
                        <svg class="w-5 h-5 mr-2 inline" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                        </svg>
                        Update Vaccine
                    </button>
                </div>
            </form>
        </div>

        <!-- Information Card -->
        <div class="mt-8 bg-blue-50 border border-blue-200 rounded-lg p-6">
            <div class="flex items-start">
                <svg class="w-6 h-6 text-blue-600 mt-0.5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                </svg>
                <div>
                    <h3 class="text-lg font-semibold text-blue-800 mb-2">Important Information</h3>
                    <ul class="text-blue-700 space-y-1">
                        <li>• Changes to vaccine name must be unique across the system</li>
                        <li>• Stock quantity will be updated immediately after saving</li>
                        <li>• The last updated date will be automatically set to today</li>
                        <li>• All changes are logged and can be tracked in the system</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Warning Card for Stock Changes -->
        <div class="mt-6 bg-yellow-50 border border-yellow-200 rounded-lg p-6">
            <div class="flex items-start">
                <svg class="w-6 h-6 text-yellow-600 mt-0.5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z"></path>
                </svg>
                <div>
                    <h3 class="text-lg font-semibold text-yellow-800 mb-2">Stock Management</h3>
                    <p class="text-yellow-700">
                        Be careful when updating stock quantities. This will immediately change the available inventory count. 
                        Consider using the "Add Stock" feature on the dashboard for adding new stock rather than manually editing the total.
                    </p>
                </div>
            </div>
        </div>
    </div>
</div>
</body>
</html>